{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "Primer template de prueba",
  "Resources": {
    "serverNum1": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "ImageId": "ami-ccafb2b3",
        "InstanceType": "t2.micro",
        "KeyName": "containers",
        "SecurityGroupIds": ["sg-4212f60f"],
        "UserData": {
          "Fn::Base64": {
            "Fn::Join": [
              "",
              [
                "#!/bin/bash -xe\n",
                "# Change the hostname to serverNum1\n",
                "hostnamectl set-hostname serverNum1\n",
                "hostnamectl\n",
                "\n"
              ]
            ]
          }
        },
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sdm",
            "Ebs": {
              "VolumeType": "gp2",
              "DeleteOnTermination": "true",
              "VolumeSize": "8"
            }
          }
        ]
      }
    },
    "dnsNum1": {
      "Type": "AWS::Route53::RecordSet",
      "Properties": {
        "HostedZoneId": "Z3GEKPUSP8P6T5",
        "Name": "serverNum1.labs.conatest.click.",
        "ResourceRecords": [{ "Fn::GetAtt": ["serverNum1", "PublicDnsName"] }],
        "TTL": "60",
        "Type": "CNAME"
      }
    },
    "sshServer": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "ImageId": "ami-09b3cc6a5e7c28c37",
        "InstanceType": "t2.micro",
        "KeyName": "containers",
        "SecurityGroupIds": ["sg-4212f60f"],
        "UserData": {
          "Fn::Base64": {
            "Fn::Join": [
              "",
              [
                "#!/bin/bash -xe\n",
                "# Change the hostname to sshServer\n",
                "hostnamectl set-hostname sshServer\n",
                "hostnamectl\n",
                "\n"
              ]
            ]
          }
        },
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sdm",
            "Ebs": {
              "VolumeType": "gp2",
              "DeleteOnTermination": "true",
              "VolumeSize": "8"
            }
          }
        ]
      }
    },
    "dnsSshServer": {
      "Type": "AWS::Route53::RecordSet",
      "Properties": {
        "HostedZoneId": "Z3GEKPUSP8P6T5",
        "Name": "sshserver.labs.conatest.click.",
        "ResourceRecords": [{ "Fn::GetAtt": ["sshServer", "PublicDnsName"] }],
        "TTL": "60",
        "Type": "CNAME"
      }
    }
  }
}
